import{r as a,j as e,b as S,k as y,x as v}from"./index-8cf87543.js";import{u as E,w as D}from"./xlsx-9de2e086.js";import{B as T}from"./Breadcrumb-9ee5e05d.js";import{P as O}from"./Pagination-0e4a8747.js";const I=()=>{const[p,k]=a.useState([]),[d,h]=a.useState(""),[b,u]=a.useState(1),[n]=a.useState(7),[f,i]=a.useState(!0);a.useEffect(()=>{(async()=>{try{const t=await v();k(t),i(!1)}catch(t){console.error("Error fetching medical records:",t),i(!1)}})()},[]);const l=p.filter(r=>{var t;return((t=r.employee)==null?void 0:t.fullName.toLowerCase().includes(d.toLowerCase()))||r.diagnosis.toLowerCase().includes(d.toLowerCase())||r.prescription.toLowerCase().includes(d.toLowerCase())}),x=b*n,m=x-n,j=l.slice(m,x),N=Math.ceil(l.length/n),w=r=>{u(r)},R=()=>{const r="MedicalRecords.xlsx",t="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8",c=l.map(o=>{var g;return{"Patient Name":(g=o.employee)==null?void 0:g.fullName,"Record Date":y(new Date(o.dateOfRecord)),Diagnosis:o.diagnosis,Treatment:o.prescription,Notes:o.comments}}),C={Sheets:{"Medical Records":E.json_to_sheet(c)},SheetNames:["Medical Records"]},L=D(C,{bookType:"xlsx",type:"array"}),M=new Blob([L],{type:t}),P=URL.createObjectURL(M),s=document.createElement("a");s.href=P,s.download=r,document.body.appendChild(s),s.click(),document.body.removeChild(s)};return f?e.jsx(S,{}):e.jsxs(e.Fragment,{children:[e.jsx(T,{pageName:"View Employee Medical Records"}),e.jsxs("div",{className:"container mx-auto py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("input",{type:"text",placeholder:"Search by patient name, diagnosis, or treatment",value:d,onChange:r=>h(r.target.value),className:"border w-1/2 border-gray-200 dark:border-strokedark rounded px-3 py-2 w-full mr-4 focus:outline-none focus:border-primary dark:bg-boxdark"}),e.jsx("button",{onClick:R,className:"bg-primary text-white text-sm font-bold py-1 px-2 rounded focus:outline-none hover:bg-primary-dark",children:"Export to Excel"})]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"table-auto rounded-lg mt-6 w-full border-collapse border border-gray-200 dark:border-strokedark dark:text-white",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-800 text-center text-md border-b border-gray-200 dark:border-strokedark",children:"S/N"}),e.jsx("th",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-800 text-center text-md border-b border-gray-200 dark:border-strokedark",children:"Patient Name"}),e.jsx("th",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-800 text-center text-md border-b border-gray-200 dark:border-strokedark",children:"Record Date"}),e.jsx("th",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-800 text-center text-md border-b border-gray-200 dark:border-strokedark",children:"Diagnosis"}),e.jsx("th",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-800 text-center text-md border-b border-gray-200 dark:border-strokedark",children:"Treatment"}),e.jsx("th",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-800 text-center text-md border-b border-gray-200 dark:border-strokedark",children:"Notes"})]})}),e.jsx("tbody",{children:j.map((r,t)=>{var c;return e.jsxs("tr",{className:`${t%2===0?"bg-gray-50 dark:bg-gray-900":"bg-white dark:bg-boxdark"}`,children:[e.jsx("td",{className:"px-4 py-6 border border-gray-200 text-center text-sm border-b border-gray-200 dark:border-strokedark",children:m+t+1}),e.jsx("td",{className:"px-4 py-6 border border-gray-200 text-center text-sm border-b border-gray-200 dark:border-strokedark",children:(c=r.employee)==null?void 0:c.fullName}),e.jsx("td",{className:"px-4 py-6 border border-gray-200 text-center text-sm border-b border-gray-200 dark:border-strokedark",children:y(new Date(r.dateOfRecord))}),e.jsx("td",{className:"px-4 py-6 border border-gray-200 text-center text-sm border-b border-gray-200 dark:border-strokedark",children:r.diagnosis}),e.jsx("td",{className:"px-4 py-6 border border-gray-200 text-center text-sm border-b border-gray-200 dark:border-strokedark",children:r.prescription}),e.jsx("td",{className:"px-4 py-6 border border-gray-200 text-center text-sm border-b border-gray-200 dark:border-strokedark",children:r.comments})]},r.recordId)})})]}),e.jsx(O,{currentPage:b,totalPages:N,onPageChange:w})]})]})]})};export{I as default};
