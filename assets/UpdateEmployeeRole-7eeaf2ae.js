import{c as I,a as b,r as n,j as e,b as N,f as j,$ as R,n as c,a0 as v}from"./index-8cf87543.js";import{B as w}from"./Breadcrumb-9ee5e05d.js";const S=()=>{const p=I(),f=b(),{employee:o}=p.state||{},[l,i]=n.useState({roleId:0,roleName:""}),[m,y]=n.useState([]),[u,s]=n.useState(!0);n.useEffect(()=>{(async()=>{if(!(o!=null&&o.employeeId)){s(!1);return}try{const[r,a]=await Promise.all([j(o.employeeId),R()]),d=a.find(h=>h.roleId===r.roleId);i({roleId:r.roleId||0,roleName:d?d.roleName:""}),y(a)}catch(r){console.error("Error fetching employee or roles:",r)}finally{s(!1)}})()},[o==null?void 0:o.employeeId]);const x=t=>{const r=parseInt(t.target.value,10),a=m.find(d=>d.roleId===r);i({roleId:r,roleName:a?a.roleName:""})},g=async t=>{if(t.preventDefault(),!l.roleId){c.error("Role is required.");return}s(!0);try{await v((o==null?void 0:o.employeeId)??0,{roleId:l.roleId,roleName:l.roleName}),c.success("Employee role updated successfully!",{duration:5e3}),f("/employee/view-employees")}catch(r){console.error("Error updating employee role:",r),c.error("Failed to update employee role. Please try again.")}finally{s(!1)}};return u?e.jsx(N,{}):e.jsxs(e.Fragment,{children:[e.jsx(w,{pageName:"Update Role"}),e.jsxs("div",{className:"container py-8 px-6 bg-gray-900 rounded-lg shadow-lg",children:[e.jsxs("h1",{className:"text-3xl font-bold text-center mb-8 dark:text-white",children:["Update ",o==null?void 0:o.fullName,"'s Role"]}),e.jsxs("form",{onSubmit:g,className:"w-3/4 mx-auto",children:[e.jsxs("div",{className:"mb-4 w-full bg-white shadow-md rounded-md p-4",children:[e.jsx("label",{htmlFor:"roleId",className:"block text-md font-medium font-bold text-gray-700 dark:text-black dark:font-bold",children:"Select Role"}),e.jsxs("select",{id:"roleId",name:"roleId",value:l.roleId.toString(),onChange:x,required:!0,className:"mt-1 block w-full border-gray-300 rounded-md focus:ring-primary focus:border-primary focus:outline-none sm:text-sm",children:[e.jsx("option",{value:"",disabled:!0,children:"Select New Role"}),m.map(t=>e.jsx("option",{value:t.roleId,children:t.roleName},t.roleId))]})]}),e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx("button",{type:"submit",className:"bg-primary text-white py-3 px-6 rounded-lg font-medium transition hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary-dark",children:u?"Updating...":"Update Role"})})]})]})]})};export{S as default};
