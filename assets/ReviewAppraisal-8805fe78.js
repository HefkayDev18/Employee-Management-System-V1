import{r,j as e,b as R,k as I,l as L,_ as l,m as D,S as j,o as T,p as M,q as z}from"./index-8cf87543.js";import{P as $}from"./Pagination-0e4a8747.js";import{B as V}from"./Breadcrumb-9ee5e05d.js";const U=()=>{const[x,g]=r.useState([]),[c,h]=r.useState(1),[p,Y]=r.useState(5),[w,b]=r.useState(0),[n,k]=r.useState("Pending"),[C,y]=r.useState(!0),[a,o]=r.useState(null),[m,d]=r.useState(!1);r.useEffect(()=>{(async()=>{y(!0);try{const s=await L(n,c,p);s&&Array.isArray(s.items)?(g(s.items),b(s.totalCount||0)):(g([]),b(0))}catch(s){l.error("Failed to fetch appraisals"),console.error("Failed to fetch appraisals:",s)}finally{y(!1)}})()},[n,c,p]);const u=t=>{k(t),h(1)},N=t=>{h(t)},A=async t=>{try{const s=await D(t);s?(o(s),d(!1)):l.error("Appraisal not found")}catch(s){l.error("Failed to fetch appraisal details"),console.error("Failed to fetch appraisal details:",s)}},v=()=>{o(null)},S=async t=>{if((await j.fire({title:"Appraisal Approval!",html:'<div style="color: green"><small>Are you sure you want to approve this appraisal? <p>Cannot be overwritten till 6 months, if approved!!</p></small></div>',icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, approve!"})).isConfirmed&&a)try{await T(t,a.managerComment),l.success("Appraisal approved successfully"),o(null)}catch(i){l.error("Failed to approve appraisal"),console.error("Failed to approve appraisal:",i)}},P=async t=>{if((await j.fire({title:"Appraisal Rejection!",html:'<div style="color: red"><small>Are you sure you want to reject this appraisal? <p>Cannot be overwritten till 6 months, if rejected!!</p></small></div>',icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, reject!"})).isConfirmed&&a)try{await M(t,a.managerComment),l.success("Appraisal rejected successfully"),o(null)}catch(i){l.error("Failed to reject appraisal"),console.error("Failed to reject appraisal:",i)}},F=()=>{d(!0)},B=async()=>{if(a)try{await z(a.appraisalId,a.status,a.managerComment),l.success("Appraisal updated successfully"),d(!1)}catch(t){l.error("Failed to update appraisal"),console.error("Failed to update appraisal:",t)}},E=t=>{a&&o({...a,managerComment:t.target.value})};return C?e.jsx(R,{}):e.jsxs(e.Fragment,{children:[e.jsx(V,{pageName:"Appraisals review"}),e.jsxs("div",{className:"container mx-auto py-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-center text-black mb-6 dark:text-white",children:"List of Current Appraisals"}),e.jsx("div",{className:"flex justify-center mb-6",children:e.jsxs("div",{className:"inline-flex shadow-md rounded-lg bg-white dark:bg-boxdark",children:[e.jsx("button",{className:`px-4 py-2 text-sm font-medium rounded-l-lg ${n==="Pending"?"bg-primary text-white":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400"}`,onClick:()=>u("Pending"),children:"Pending"}),e.jsx("button",{className:`px-4 py-2 text-sm font-medium ${n==="Approved"?"bg-primary text-white":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400"}`,onClick:()=>u("Approved"),children:"Approved"}),e.jsx("button",{className:`px-4 py-2 text-sm font-medium rounded-r-lg ${n==="Rejected"?"bg-primary text-white":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400"}`,onClick:()=>u("Rejected"),children:"Rejected"})]})}),e.jsxs("div",{className:"rounded-lg shadow-md px-8 bg-white dark:bg-boxdark p-4",children:[e.jsx("ul",{className:"divide-y divide-gray-200 dark:divide-gray-800",children:x.length>0?x.map(t=>{var s,i,f;return e.jsx("li",{className:"py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-md font-medium text-gray-800 dark:text-white",children:e.jsxs("b",{children:["Employee Name: ",((s=t.employee)==null?void 0:s.fullName)||"Unknown"]})}),e.jsxs("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:["Position: ",((i=t.employee)==null?void 0:i.position)||"N/A"]}),e.jsxs("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:["Department: ",((f=t.employee)==null?void 0:f.department)||"N/A"]})]}),e.jsx("button",{className:"text-sm font-medium text-primary dark:text-white",onClick:()=>A(t.appraisalId),children:"View Appraisal"})]})},t.appraisalId)}):e.jsx("li",{className:"py-4 text-center text-3xl text-gray-600 dark:text-gray-400",children:e.jsx("b",{children:"No appraisals found."})})}),e.jsx($,{currentPage:c,totalPages:Math.ceil(w/p),onPageChange:N})]})]}),a&&e.jsxs("div",{className:"fixed inset-0 flex items-center mt-15 justify-center z-80 overflow-auto",children:[e.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-100",onClick:v}),e.jsxs("div",{className:"relative bg-gradient-to-br from-gray-100 via-white to-boxdark dark:bg-black dark:from-gray-900 dark:to-gray-700 rounded-xl shadow-2xl w-full max-w-3xl p-6 z-10 overflow-auto md:ml-20",children:[e.jsx("button",{className:"absolute top-3 right-3 p-2 text-gray-500 dark:text-gray-300",onClick:v,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h2",{className:"text-2xl font-semibold mb-6 text-gray-900 dark:text-white",children:e.jsx("b",{children:"Appraisal Details"})}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:[{label:"Publication Progress:",value:a.publicationProgress+"%"},{label:"Teaching:",value:a.teaching+"%"},{label:"Patent Conferencing:",value:a.patentConferencing+"%"},{label:"Community Service:",value:a.communityService+"%"},{label:"Administration Experience:",value:a.administrationExperience+"%"},{label:"Communication:",value:a.communication+"%"},{label:"Teamwork:",value:a.teamwork+"%"},{label:"Leadership:",value:a.leadership+"%"},{label:"Problem Solving:",value:a.problemSolving+"%"},{label:"Punctuality:",value:a.punctuality+"%"},{label:"Adaptability:",value:a.adaptability+"%"},{label:"Overall Satisfaction:",value:a.overallSatisfaction+"%"},{label:"Comments:",value:a.comments},{label:"Manager Comment:",value:m?e.jsx("textarea",{className:"mt-1 w-full border rounded-lg p-2 dark:bg-gray-800 dark:text-gray-300",value:a.managerComment,onChange:E}):a.managerComment},{label:"Status:",value:e.jsx("p",{className:`font-semibold ${a.status==="Pending"?"text-warning dark:text-warning":a.status==="Approved"?"text-success dark:text-success":"text-danger dark:text-danger"}`,children:a.status})},{label:"Date Created:",value:I(a.appDateCreated)}].map((t,s)=>e.jsx("div",{className:"border p-2 rounded-lg",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("strong",{className:"text-gray-800 dark:text-gray-200 text-xs dark:text-white",children:t.label}),e.jsx("div",{className:"text-gray-700 text-xs dark:text-white",children:e.jsx("b",{children:t.value})})]})},s))}),e.jsxs("div",{className:"mt-6 flex justify-between",children:[!m&&a.status!=="Approved"&&a.status!=="Rejected"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary",onClick:F,children:"Edit"}),e.jsx("button",{className:"px-4 py-2 bg-success text-white rounded-lg hover:bg-success",onClick:()=>S(a.appraisalId),children:"Approve"}),e.jsx("button",{className:"px-4 py-2 bg-danger text-white rounded-lg hover:bg-danger",onClick:()=>P(a.appraisalId),children:"Reject"})]}),m&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"px-4 py-2 bg-success text-white rounded-lg hover:bg-success",onClick:B,children:"Save"}),e.jsx("button",{className:"px-4 py-2 bg-boxdark text-white rounded-lg hover:bg-boxdark",onClick:()=>d(!1),children:"Cancel"})]})]})]})]})]})};export{U as default};
