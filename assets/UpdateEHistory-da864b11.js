import{a as b,c as E,r as i,j as e,b as j,f as v,n as s,e as N,i as w}from"./index-8cf87543.js";import{B as k}from"./Breadcrumb-9ee5e05d.js";const H=()=>{var h;const p=b(),d=(h=E().state)==null?void 0:h.employeeId,[x,m]=i.useState(!0),[c,f]=i.useState(null),[o,y]=i.useState({dateEmployed:"",dateRelieved:"",duration:"",currentlyEmployed:!1,description:""});i.useEffect(()=>{const r=async()=>{try{const t=await v(d);t&&f(t)}catch(t){console.error("Error fetching employee:",t),s.error("Failed to load employee data")}},a=async()=>{try{const t=await N(d);if(t&&t.employmentHistories&&t.employmentHistories.length>0){const n=t.employmentHistories[0];y({dateEmployed:new Date(n.dateEmployed).toISOString().split("T")[0],dateRelieved:o.dateRelieved||"",duration:" ",currentlyEmployed:o.currentlyEmployed,description:n.description})}else s.error("No employment history found")}catch(t){console.error("Error fetching employee history:",t),s.error("Failed to load employee history")}finally{m(!1)}};r(),a()},[d]);const l=r=>{const{name:a,type:t,value:n}=r.target;y(t==="checkbox"?u=>({...u,[a]:r.target.checked}):u=>({...u,[a]:n}))},g=async r=>{r.preventDefault(),m(!0);const a={...o,dateRelieved:o.currentlyEmployed?null:o.dateRelieved};try{await w(d,a),s.success("Employment history updated successfully!",{duration:5e3,onClose:()=>p("/core-features/history")}),p("/core-features/history")}catch(t){console.error("Error updating employee history:",t),s.error("Failed to update employment history. Please try again.")}finally{m(!1)}};return x?e.jsx(j,{}):e.jsxs(e.Fragment,{children:[e.jsx(k,{pageName:"Update Employment History"}),e.jsxs("div",{className:"container py-8 px-6 bg-gray-900 rounded-lg shadow-lg",children:[e.jsxs("h1",{className:"text-3xl font-bold text-center mb-8 dark:text-white",children:["Update ",(c==null?void 0:c.fullName)+"'s"," History Info"]}),e.jsxs("form",{onSubmit:g,className:"max-w-full",children:[e.jsxs("div",{className:"flex justify-around gap-5",children:[e.jsxs("div",{className:"mb-4 w-1/2 bg-white shadow-md rounded-md p-4",children:[e.jsx("label",{htmlFor:"dateEmployed",className:"block text-sm font-medium text-gray-700 dark:text-black dark:font-bold",children:"Date Employed"}),e.jsx("input",{type:"date",id:"dateEmployed",name:"dateEmployed",value:o.dateEmployed,onChange:l,className:"mt-1 block w-full border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500 focus:outline-none sm:text-sm",required:!0}),e.jsx("p",{className:"mt-1 text-xs font-bold text-gray-500",children:"Date Format: mm/dd/yyy "})]}),e.jsxs("div",{className:"mb-4 w-1/2 bg-white shadow-md rounded-md p-4",children:[e.jsx("label",{htmlFor:"dateRelieved",className:"block text-sm font-medium text-gray-700 dark:text-black dark:font-bold",children:"Date Relieved"}),e.jsx("input",{type:"date",id:"dateRelieved",name:"dateRelieved",value:o.currentlyEmployed?"":o.dateRelieved,onChange:l,className:"mt-1 block w-full border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500 focus:outline-none sm:text-sm",disabled:o.currentlyEmployed,required:!o.currentlyEmployed}),o.currentlyEmployed?e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Leave Date Relieved empty if currently employed"}):e.jsx("p",{className:"mt-1 text-xs font-bold text-gray-500",children:"Date Format: mm/dd/yyy "})]})]}),e.jsxs("div",{className:"flex justify-around gap-5",children:[e.jsxs("div",{className:"mb-4 w-1/2 bg-white shadow-md rounded-md p-4",children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 dark:text-black dark:font-bold",children:"Description"}),e.jsx("textarea",{id:"description",name:"description",value:o.description,onChange:l,className:"mt-1 block w-full border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500 focus:outline-none sm:text-sm",rows:4,required:!0})]}),e.jsxs("div",{className:"mb-4 w-1/2 bg-white shadow-md rounded-md p-4",children:[e.jsx("label",{htmlFor:"currentlyEmployed",className:"text-sm font-medium text-gray-700 dark:text-white dark:font-bold",children:"Currently Employed?"}),e.jsx("input",{type:"checkbox",id:"currentlyEmployed",name:"currentlyEmployed",checked:o.currentlyEmployed,onChange:l,className:"mx-2 leading-tight text-xl"})]})]}),e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx("button",{type:"submit",className:"bg-primary text-white py-3 px-6 rounded-lg font-medium transition hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary-dark",children:x?"Updating...":"Update History"})})]})]})]})};export{H as default};
