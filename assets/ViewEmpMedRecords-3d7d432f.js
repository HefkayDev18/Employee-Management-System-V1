import{r as a,u as S,j as e,b as E,k,y as D}from"./index-8cf87543.js";import{u as T,w as O}from"./xlsx-9de2e086.js";import{B}from"./Breadcrumb-9ee5e05d.js";import{P as F}from"./Pagination-0e4a8747.js";const $=()=>{const[b,h]=a.useState([]),[c,u]=a.useState(""),[x,f]=a.useState(1),[l]=a.useState(7),[j,m]=a.useState(!0),{user:s}=S();a.useEffect(()=>{(async()=>{if(s!=null&&s.employeeObj.employeeId)try{const t=await D(s.employeeObj.employeeId);h(t)}catch(t){console.error("Error fetching medical records:",t)}finally{m(!1)}else m(!1)})()},[s]);const i=b.filter(r=>{var t;return((t=r.employee)==null?void 0:t.fullName.toLowerCase().includes(c.toLowerCase()))||r.diagnosis.toLowerCase().includes(c.toLowerCase())||r.prescription.toLowerCase().includes(c.toLowerCase())}),g=x*l,y=g-l,N=i.slice(y,g),w=Math.ceil(i.length/l),R=r=>{f(r)},C=()=>{const r="MedicalRecords.xlsx",t="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8",n=i.map(d=>{var p;return{"Patient Name":(p=d.employee)==null?void 0:p.fullName,"Record Date":k(new Date(d.dateOfRecord)),Diagnosis:d.diagnosis,Treatment:d.prescription,Notes:d.comments}}),v={Sheets:{"Medical Records":T.json_to_sheet(n)},SheetNames:["Medical Records"]},L=O(v,{bookType:"xlsx",type:"array"}),M=new Blob([L],{type:t}),P=URL.createObjectURL(M),o=document.createElement("a");o.href=P,o.download=r,document.body.appendChild(o),o.click(),document.body.removeChild(o)};return j?e.jsx(E,{}):e.jsxs(e.Fragment,{children:[e.jsx(B,{pageName:"View Employee Medical Records"}),e.jsxs("div",{className:"container mx-auto py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("input",{type:"text",placeholder:"Search by patient name, diagnosis, or treatment",value:c,onChange:r=>u(r.target.value),className:"border w-1/2 border-gray-200 dark:border-strokedark rounded px-3 py-2 w-full mr-4 focus:outline-none focus:border-primary dark:bg-boxdark"}),e.jsx("button",{onClick:C,className:"bg-primary text-white text-sm font-bold py-1 px-2 rounded focus:outline-none hover:bg-primary-dark",children:"Export to Excel"})]}),e.jsx("div",{className:"overflow-x-auto",children:b.length===0?e.jsx("div",{className:"text-center py-4 text-xl font-semibold text-gray-700 dark:text-gray-300",children:"No medical records available"}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"table-auto rounded-lg mt-6 w-full border-collapse border border-gray-200 dark:border-strokedark dark:text-white",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-800 text-center text-md border-b border-gray-200 dark:border-strokedark",children:"S/N"}),e.jsx("th",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-800 text-center text-md border-b border-gray-200 dark:border-strokedark",children:"Patient Name"}),e.jsx("th",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-800 text-center text-md border-b border-gray-200 dark:border-strokedark",children:"Record Date"}),e.jsx("th",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-800 text-center text-md border-b border-gray-200 dark:border-strokedark",children:"Diagnosis"}),e.jsx("th",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-800 text-center text-md border-b border-gray-200 dark:border-strokedark",children:"Treatment"}),e.jsx("th",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-800 text-center text-md border-b border-gray-200 dark:border-strokedark",children:"Notes"})]})}),e.jsx("tbody",{children:N.map((r,t)=>{var n;return e.jsxs("tr",{className:`${t%2===0?"bg-gray-50 dark:bg-gray-900":"bg-white dark:bg-boxdark"}`,children:[e.jsx("td",{className:"px-4 py-6 border border-gray-200 text-center text-sm border-b border-gray-200 dark:border-strokedark",children:y+t+1}),e.jsx("td",{className:"px-4 py-6 border border-gray-200 text-center text-sm border-b border-gray-200 dark:border-strokedark",children:(n=r.employee)==null?void 0:n.fullName}),e.jsx("td",{className:"px-4 py-6 border border-gray-200 text-center text-sm border-b border-gray-200 dark:border-strokedark",children:k(new Date(r.dateOfRecord))}),e.jsx("td",{className:"px-4 py-6 border border-gray-200 text-center text-sm border-b border-gray-200 dark:border-strokedark",children:r.diagnosis}),e.jsx("td",{className:"px-4 py-6 border border-gray-200 text-center text-sm border-b border-gray-200 dark:border-strokedark",children:r.prescription}),e.jsx("td",{className:"px-4 py-6 border border-gray-200 text-center text-sm border-b border-gray-200 dark:border-strokedark",children:r.comments})]},r.recordId)})})]}),e.jsx(F,{currentPage:x,totalPages:w,onPageChange:R})]})})]})]})};export{$ as default};
