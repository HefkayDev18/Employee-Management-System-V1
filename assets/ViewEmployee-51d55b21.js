import{u as f,r as d,v as V,a as Y,j as e,b as G,V as N,k as c,W as j,K as H,g as K,S as w,X as M,n as C}from"./index-8cf87543.js";import{B as W}from"./Breadcrumb-9ee5e05d.js";import{u as X,w as $}from"./xlsx-9de2e086.js";import{P as q}from"./Pagination-0e4a8747.js";const ee=()=>{const{isLoggedIn:x}=f(),[v,y]=d.useState([]),[g,E]=d.useState(""),[p,R]=d.useState(1),[b]=d.useState(7),[S,k]=d.useState(!0);V();const i=Y(),{user:o}=f();d.useEffect(()=>{x&&(async()=>{try{const t=await K();y(t),k(!1)}catch(t){console.error("Error fetching employees:",t),k(!1)}})()},[x]);const m=v.filter(r=>{const t=g.toLowerCase(),s=r.isActive?"active":"not active",l=r.roleName;return r.fullName.toLowerCase().includes(t)||r.email.toLowerCase().includes(t)||r.phoneNumber.toLowerCase().includes(t)||r.position.toLowerCase().includes(t)||r.department.toLowerCase().includes(t)||s.includes(t)||l.toLowerCase().includes(t)}),h=p*b,u=h-b,B=m.slice(u,h),A=Math.ceil(m.length/b),D=r=>{R(r)},L=r=>{i("/employee/update-employee",{state:{employee:r}})},P=async r=>{(await w.fire({title:"Role Update",html:`<span style="color: orange">Are you sure you want to update this employee's role?</span>`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, confirmed!"})).isConfirmed&&i("/employee/update-employee-role",{state:{employee:r}})},T=async r=>{if((await w.fire({title:"Are you sure?",html:'<span style="color: red">You will not be able to recover this employee once deleted!</span>',icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete!"})).isConfirmed)try{await M(r),y(s=>s.filter(l=>l.employeeId!==r)),C.success("Employee record deleted successfully!",{duration:5e3}),i("/employee/view-employees")}catch{C.error("Failed to delete employee record. Please try again.")}},U=()=>{const r="EmployeeRecords.xlsx",t="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8",s=m.map(a=>({"Full Name":a.fullName,Email:a.email,"Phone Number":a.phoneNumber,Gender:a.gender,Position:a.position,Department:a.department,Salary:N(a.salary),Status:a.isActive?"Active":"Not Active","Date Created":c(new Date(a.dateCreated)),Age:j(a.dateOfBirth),"Date of Birth":c(new Date(a.dateOfBirth)),Role:a.roleName})),F={Sheets:{"Employee Records":X.json_to_sheet(s)},SheetNames:["Employee Records"]},O=$(F,{bookType:"xlsx",type:"array"}),I=new Blob([O],{type:t}),_=URL.createObjectURL(I),n=document.createElement("a");n.href=_,n.download=r,document.body.appendChild(n),n.click(),document.body.removeChild(n)};return S?e.jsx(G,{}):e.jsxs(e.Fragment,{children:[e.jsx(W,{pageName:"View Employees"}),e.jsxs("div",{className:"container mx-auto py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("input",{type:"text",placeholder:"Search by full name, email, role, status, phone number, position, or department",value:g,onChange:r=>E(r.target.value),className:"border w-1/2 border-gray-200 dark:border-strokedark rounded px-3 py-2 w-full mr-4 focus:outline-none focus:border-primary dark:bg-boxdark"}),e.jsx("button",{onClick:U,className:"bg-primary text-white text-sm font-bold py-1 px-2 rounded focus:outline-none hover:bg-primary-dark",children:"Export to Excel"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table-auto rounded-lg mt-6 w-full border-collapse border border-gray-200 dark:border-strokedark dark:text-white",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-800 text-center text-md border-b border-gray-200 dark:border-strokedark",children:"S/N"}),e.jsx("th",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-800 text-center text-md border-b border-gray-200 dark:border-strokedark",children:"Full Name"}),e.jsx("th",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-800 text-center text-md border-b border-gray-200 dark:border-strokedark",children:"Email"}),e.jsx("th",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-800 text-center text-md border-b border-gray-200 dark:border-strokedark",children:"Phone Number"}),e.jsx("th",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-800 text-center text-md border-b border-gray-200 dark:border-strokedark",children:"Gender"}),e.jsx("th",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-800 text-center text-md border-b border-gray-200 dark:border-strokedark",children:"Position"}),e.jsx("th",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-800 text-center text-md border-b border-gray-200 dark:border-strokedark",children:"Department"}),e.jsx("th",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-800 text-center text-md border-b border-gray-200 dark:border-strokedark",children:"Salary (₦)"}),e.jsx("th",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-800 text-center text-md border-b border-gray-200 dark:border-strokedark",children:"Status"}),e.jsx("th",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-800 text-center text-md border-b border-gray-200 dark:border-strokedark",children:"Date Created"}),e.jsx("th",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-800 text-center text-md border-b border-gray-200 dark:border-strokedark",children:"Age"}),e.jsx("th",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-800 text-center text-md border-b border-gray-200 dark:border-strokedark",children:"Date of Birth"}),e.jsx("th",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-800 text-center text-md border-b border-gray-200 dark:border-strokedark",children:"Role"}),(o==null?void 0:o.role)==="HR_Admin"&&e.jsx("th",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-800 text-center text-md border-b border-gray-200 dark:border-strokedark",children:"Actions"})]})}),e.jsx("tbody",{children:B.map((r,t)=>e.jsxs("tr",{className:`${t%2===0?"bg-gray-50 dark:bg-gray-900":"bg-white dark:bg-boxdark"}`,children:[e.jsx("td",{className:"px-4 py-6 border border-gray-200 text-center text-sm border-b border-gray-200 dark:border-strokedark",children:u+t+1}),e.jsx("td",{className:"px-4 py-6 border border-gray-200 text-center text-sm border-b border-gray-200 dark:border-strokedark",children:r.fullName}),e.jsx("td",{className:"px-4 py-6 border border-gray-200 text-center text-sm border-b border-gray-200 dark:border-strokedark",children:r.email}),e.jsx("td",{className:"px-4 py-6 border border-gray-200 text-center text-sm border-b border-gray-200 dark:border-strokedark",children:r.phoneNumber}),e.jsx("td",{className:"px-4 py-6 border border-gray-200 text-center text-sm border-b border-gray-200 dark:border-strokedark",children:r.gender}),e.jsx("td",{className:"px-4 py-6 border border-gray-200 text-center text-sm border-b border-gray-200 dark:border-strokedark",children:r.position}),e.jsx("td",{className:"px-4 py-6 border border-gray-200 text-center text-sm border-b border-gray-200 dark:border-strokedark",children:r.department}),e.jsx("td",{className:"px-4 py-6 border border-gray-200 text-center text-sm border-b border-gray-200 dark:border-strokedark",children:N(r.salary)}),e.jsx("td",{className:"px-4 py-6 border border-gray-200 text-center text-sm border-b border-gray-200 dark:border-strokedark",children:r.isActive?"Active":"Not Active"}),e.jsx("td",{className:"px-4 py-6 border border-gray-200 text-center text-sm border-b border-gray-200 dark:border-strokedark",children:c(new Date(r.dateCreated))}),e.jsx("td",{className:"px-4 py-6 border border-gray-200 text-center text-sm border-b border-gray-200 dark:border-strokedark",children:j(r.dateOfBirth)}),e.jsx("td",{className:"px-4 py-6 border border-gray-200 text-center text-sm border-b border-gray-200 dark:border-strokedark",children:c(new Date(r.dateOfBirth))}),e.jsx("td",{className:"px-4 py-6 border border-gray-200 text-center text-sm border-b border-gray-200 dark:border-strokedark",children:r.roleName}),(o==null?void 0:o.role)==="HR_Admin"&&e.jsxs("td",{className:"px-4 py-4 border border-gray-200 text-center text-sm border-b border-gray-200 dark:border-strokedark",children:[e.jsx("button",{className:"bg-primary text-white text-xs py-2 px-3 rounded-md font-sm transition hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary-dark",onClick:()=>L(r),children:"Update Employee"}),e.jsx("button",{className:"bg-warning text-white text-xs py-2 px-3 mt-2 rounded-md font-sm transition hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary-dark",onClick:()=>P(r),children:"Update Role"}),e.jsx("button",{className:"bg-danger text-white  text-sm py-1.5 px-1 mt-2 rounded-md font-sm transition hover:bg-danger focus:outline-none focus:ring-2 focus:ring-red-danger",onClick:()=>T(r.employeeId),title:"Delete",children:e.jsxs("span",{children:[e.jsx(H,{className:"inline-block text-xs mr-0.5"}),e.jsx("span",{className:"text-xs mx-1",children:"Delete"})]})})]})]},r.employeeId))})]})}),e.jsx(q,{currentPage:p,totalPages:A,onPageChange:D})]})]})};export{ee as default};
